+++
date = '2025-06-10T23:45:52+09:00'
draft = false
title = '非線形時系列解析入門〜予測編〜'
math = true
tags = ["時系列分析","カオス"]
+++

<!--more-->

## 遅れ座標
決定論カオスの系は，初期値依存性により予測困難な振る舞いを示す．そのような系から得られた1次元時系列データに複数ステップ先のデータを予測していく．今回はその準備として理論をまとめる．
時系列が $x_t$ の力学系を観測することで得られるのは，1次元時系列 $y_n$ である．アトラクタの再構成には時間遅れ座標系と呼ばれる座標系への変換がよく用いられる．この変換では観測時系列 $y_t$ が以下のようにして $d$ 次元ベクトルの時系列に変換される．但し，$N$ 次元の多様体が与えられたとする．

$$
x\in N,\ f:N\rightarrow N,\ g:N \rightarrow \mathbb{R},\ G:N\rightarrow \mathbb{R}^d
$$
$$
x_{t + 1} = f(x_t),\ s_t = g(x_t) 
$$
$$
y_t = G(x_t) = (s_t,\ s_{t + \tau},\ \cdots,\ s_{t +(d-1)\tau}) 
$$

遅れ座標とは，$y_t = ...$ のように異なる時間の $s(t)$ を並べてベクトルにしたものである．ここで， $\tau$
は時間遅れの大きさ，$d$ は埋め込み次元と呼ばれる．アトラクタの再構成はTakensの埋め込み定理により保証される．一般に，$n$ 次元の多様体を考えたとき，$d \leq 2n + 1$ ならば，写像 $G$ は埋め込みであり，$x(t)$ と $G(x_t)$ は1対1に対応する．実際に実データを得た際には，元の多様体の次元 $n$ を知る方法がないため，埋め込み定理による埋め込みは保証されない．

## 状態空間の再構成
### 時間遅れの最適化
遅れ座標からアトラクタの再構成を行なうときに，$\tau$ 及び $d$ をどのような値にすべきかは，時間遅れの最適化と埋め込み次元の推定をすればよい．

時間送れの選び方の指針を与えるのは相互情報量である．一般に，確率変数 $X$ と $Y$ についての相互情報量 $I(X;Y)$ は，

$$
I(X;Y) = \sum_{x \in \Omega_X}\sum_{y\in\Omega_Y} P_{X,Y}(x,y)\log\frac{P_{X,Y}(x,y)}{P_X(x)P_Y(y)}
$$

で定義される．$\Omega_X$ は $X$ が取り得る値全体の集合，$\Omega_Y$ は $Y$ が取り得る値全体の集合を表し，$P_{X,Y}$ は同時確率分布を，$P_{X}$，$P_{Y}$ は周辺分布を表す．
ここで，$S_t$ と $S_{t + \tau}$ の相互情報量 $I(S_t, S_{t + \tau})$ は以下のように表せる．

$$
I(S_t,S_{t + \tau}) = \sum_{s_{t + \tau}\in S_{t + \tau}} \sum_{s_t \in S_t}
$$
$$P(s_t,s_{t + \tau})\log\frac{P(s_t, s_{t + \tau})}{P(s_t)P(s_{t + \tau})}
$$

そして，時間遅れ $\tau$ を変化させたときの相互情報量の最初の極小値となる $\tau$ を時間遅れとして定義る．
このような選択をとる理由は，$S_t$ と $S_{t + \tau}$ ができるだけ独立の情報の表現をしており．かつダイナミクスとして関連している2点であるような $\tau$ をなるべく小さな値で選びたいからである．$\tau$ が大きい値を取ると，$S_t$ と $S_{t + \tau}$ は初期値鋭敏性により決定論的関係性を失っていくことになるので適切ではなくなってしまう．

### 埋め込み次元の推定
適切な時間遅れを選択したあとに適切な埋め込み次元を推定していく．そのための一般的な手法として誤り近傍法がある．この手法では，まず始めに，1次元の小さな時間遅れ座標 $\vec s_t(d)$ から計算する．その後，時間遅れ座標の次元を1つずつ大きくしていき，逐次的に近傍点との距離がどれだけ増加したかを計算していく．その過程でもし距離が不自然に大きくなるような点が存在したら，その点を誤り近傍点とする．誤り近傍点は以下の式を満たす $n(t, d)$ と定義される．

$$
n(t,d) = \min_{u \neq t}\| \vec s_t(d) - \vec{s}_u(d)\|
$$

$$
\sigma(\{s_t\}) > r\|\vec s_t(d) - \vec{s}_{n(t,d)}(d)\|
$$

$$
\frac{\|\vec s_t(d + 1) - \vec{s}_ {n(t,d)}(d + 1)\|}{\|\vec s_t(d) - \vec{s}_{n(t,d)}(d)\|} > r
$$

これらを $t = 1,2,\cdots,T-(d-1)\tau$ について計算していき，誤り近傍点の割合を計算していき，次に $d$ を準に大きくしながら計算を繰り返す．誤り近傍法では，このように計算されていく誤り近傍点の割合が十分に小さいとき，その時点での埋め込み次元が適切であると考える．

### 再構成
与えられたカオス時系列データに関して，適切な時間遅れ $\tau$ と埋め込み次元 $d$ を計算し，時間遅れ座標 $\vec s_t(d)$ を構成することによって，もとのアトラクタを十分に再構成することができる．

状態空間の再構成の理論の大筋は以上．

